{% extends "includes/base.html" %}
{% load static %}

{% block title %}Equipo {{ equipo.nombre }} - Información{% endblock %}

{% block content %}
<div class="container my-5">

    <div class="row gy-5">

        <!-- COLUMNA IZQUIERDA -->
        <div class="col-md-8 order-2 order-md-1">

            <!-- Cabecera del Equipo (Ficha Técnica Mejorada) -->
            <div class="mb-4">
                <div class="d-flex align-items-center justify-content-between mb-3">
                    <h2 class="h3 text-foot-green fw-bold mb-0">
                        Información general
                    </h2>
                    <span class="badge rounded-pill bg-light text-dark border"><i class="bi bi-check-circle-fill"></i>
                        Activo</span>
                </div>

                <div class="card shadow-sm bg-card-dark mb-4 rounded-4 overflow-hidden">
                    <div class="card-body p-4">
                        <div class="row g-4">
                            <!-- Dato 1: Nombre -->
                            <div class="col-md-4">
                                <div class="d-flex align-items-center">
                                    <div
                                        class="icon-square bg-light rounded-3 p-3 me-3 d-flex align-items-center justify-content-center">
                                        <i class="bi bi-shield-fill fs-4" style="color: #27a770;"></i>
                                    </div>
                                    <div>
                                        <small class="text-secondary d-block text-uppercase fw-bold"
                                            style="font-size: 0.75rem; letter-spacing: 0.5px;">Club</small>
                                        <span class="fw-bold text-color-card">{{ equipo.nombre }}</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Dato 2: Fundación -->
                            <div class="col-md-4">
                                <div class="d-flex align-items-center">
                                    <div
                                        class="icon-square bg-light rounded-3 p-3 me-3 d-flex align-items-center justify-content-center">
                                        <i class="bi bi-calendar-event-fill fs-4" style="color: #27a770;"></i>
                                    </div>
                                    <div>
                                        <small class="text-secondary d-block text-uppercase fw-bold"
                                            style="font-size: 0.75rem; letter-spacing: 0.5px;">Fundación</small>
                                        <span class="fw-bold text-color-card">{{ equipo.anio_fundacion }}</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Dato 3: Registro -->
                            <div class="col-md-4">
                                <div class="d-flex align-items-center">
                                    <div
                                        class="icon-square bg-light rounded-3 p-3 me-3 d-flex align-items-center justify-content-center">
                                        <i class="bi bi-clock-history fs-4" style="color: #27a770;"></i>
                                    </div>
                                    <div>
                                        <small class="text-secondary d-block text-uppercase fw-bold"
                                            style="font-size: 0.75rem; letter-spacing: 0.5px;">Alta en App</small>
                                        <span class="fw-bold text-color-card">{{ equipo.fecha_creacion|date:"d M Y" }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            {% if is_trainer %}
            <div class="mb-5">
                <a href="#" class="btn btn-foot-form-enviar px-4 py-2" data-bs-toggle="modal"
                    data-bs-target="#updateProfileModal">
                    <i class="bi bi-shield-shaded"></i> Editar información de equipo
                </a>
            </div>
            {% endif %}


            <!-- MODAL DE ACTUALIZACIÓN -->
            <div class="modal fade" id="updateProfileModal" tabindex="-1" aria-labelledby="updateModalLabel"
                aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered modal-lg">
                    <div class="modal-content rounded-4 border-0 shadow">
                        <div class="modal-header border-bottom">
                            <h5 class="modal-title fw-bold" id="updateModalLabel" style="color: #27a770;"><i
                                    class="bi bi-shield-shaded"></i> Editar información de equipo</h5>
                        </div>

                        <div class="modal-body p-4">
                            <form id="formulario_editar_datos" method="POST" enctype="multipart/form-data">
                                {% csrf_token %}
                                <div class="row g-3">

                                    <div class="col-md-6">
                                        <label for="nombreEquipo" class="form-label fw-medium">Nombre</label>
                                        <input type="text" class="form-control rounded-3" id="nombreEquipo" name="first_name"
                                            value="{{ equipo.nombre }}">
                                        <small id="errorNombre" class="help-text text-danger"
                                            aria-live="polite"></small>
                                    </div>

                                    <div class="col-md-6">
                                        <label for="anioFundacion" class="form-label fw-medium">Año de
                                            fundación</label>
                                        <input type="number" class="form-control rounded-3" id="anioFundacion"
                                            name="anio_fundacion" value="{{ equipo.anio_fundacion }}">
                                        <small id="errorAnioFundacion" class="help-text text-danger"
                                            aria-live="polite"></small>
                                    </div>

                                    <div class="col-md-6">
                                        <label for="direccionEquipo" class="form-label fw-medium">Dirección</label>
                                        <input type="text" class="form-control rounded-3" id="direccionEquipo"
                                            name="direccion" value="{{ equipo.direccion }}">
                                        <small id="errorDireccion" class="help-text text-danger"
                                            aria-live="polite"></small>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="telefonoEquipo" class="form-label fw-medium">Teléfono</label>
                                        <input type="tel" class="form-control rounded-3"
                                            id="telefonoEquipo" name="telefono" value="{{ equipo.telefono }}">
                                            <small id="errorTelefono" class="help-text text-danger"
                                            aria-live="polite"></small>
                                    </div>

                                    <div class="col-md-6">
                                        <label for="color_principal" class="form-label fw-medium">Color
                                            principal</label>
                                        <input type="color" class="form-control rounded-3" id="color_principal"
                                            name="color_principal" value="{{ equipo.color_principal }}">
                                        <small id="errorColorPrincipal" class="help-text text-danger"
                                            aria-live="polite"></small>
                                    </div>

                                    <div class="col-md-6">
                                        <label for="color_secundario" class="form-label fw-medium">Color
                                            secundario</label>
                                        <input type="color" class="form-control rounded-3" id="color_secundario"
                                            name="color_secundario" value="{{ equipo.color_secundario }}">
                                        <small id="errorColorSecundario" class="help-text text-danger"
                                            aria-live="polite"></small>
                                    </div>

                                    <div class="col-md-6">
                                        <label for="escudo" class="form-label fw-medium">Escudo</label>
                                        <input type="file" class="form-control rounded-3" id="escudo" name="escudo"
                                            accept="image/*">
                                        <div class="form-text">Sube una nueva imagen solo si quieres cambiar el escudo
                                            actual.
                                        </div>
                                    </div>

                                    <!-- Vista previa -->
                                    <div class="col-md-6 mt-3 text-center">
                                        <img id="previewFoto"
                                            src="{% if equipo.escudo %}{{ equipo.escudo.url }}{% else %}{% static 'img/default_shield.png' %}{% endif %}"
                                            data-original="{% if equipo.escudo %}{{ equipo.escudo.url }}{% else %}{% static 'img/default_shield.png' %}{% endif %}"
                                            alt="Vista previa" class="rounded-4 shadow-sm"
                                            style="width: 200px; height: 200px; object-fit: cover;">
                                    </div>

                                </div>

                                <div class="d-flex justify-content-end gap-2 mt-4">
                                    <button type="button" class="btn btn-light text-secondary px-4 rounded-3"
                                        data-bs-dismiss="modal">Cancelar</button>
                                    <button type="submit" class="btn text-white px-4 rounded-3"
                                        style="background-color: #27a770;">Guardar cambios</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!-- FIN MODAL -->

            {% if messages %}
            {% for message in messages %}
            <div class="modal fade" id="modalEditarDatosEquipoOk" tabindex="-1">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header bg-success">
                            <h5 class="modal-title text-white">Información del equipo actualizada</h5>
                        </div>
                        <div class="modal-body">
                            <p>{{ message }}</p>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
            {% endif %}

            {% if error %}
            <div class="modal fade" id="modalErrorEditarEquipo" tabindex="-1">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header bg-danger">
                            <h5 class="modal-title text-white">Error al actualizar información</h5>
                        </div>
                        <div class="modal-body">
                            <p>{{ error }}</p>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                                Cerrar
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}

            <!-- Sección Entrenador -->
<div class="mb-5">
    <h3 class="h4 text-foot-green fw-bold mb-2">Entrenador</h3>
    {% if entrenador %}
    <a href="{% url 'usuarios:ver_perfil_usuario' entrenador.perfil_entrenador.usuario.slug %}" class="text-decoration-none">
        <div class="card shadow-sm bg-card-dark rounded-4" style="cursor: pointer; transition: all 0.3s ease;">
            <div class="card-body p-4">
                <div class="d-flex align-items-center">
                    <img src="{% if entrenador.perfil_entrenador.usuario.foto %}{{ entrenador.perfil_entrenador.usuario.foto.url }}{% else %}{% static 'img/default_avatar.jpg' %}{% endif %}" 
                        class="rounded-circle me-3" width="70" height="70" style="object-fit: cover;">
                    <div>
                        <h5 class="mb-1 fw-bold text-color-card">{{ entrenador.perfil_entrenador.usuario.get_full_name }}</h5>
                        <p class="mb-1 text-secondary">
                            <small><i class="bi bi-briefcase-fill"></i> Experiencia: {{ entrenador.perfil_entrenador.experiencia_anos }} años</small>
                        </p>
                        {% if entrenador.perfil_entrenador.licencia %}
                        <p class="mb-0 text-secondary">
                            <small><i class="bi bi-award-fill"></i> Licencia: {{ entrenador.perfil_entrenador.licencia }}</small>
                        </p>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </a>
    {% else %}
    <div class="alert alert-warning">
        <i class="bi bi-exclamation-triangle-fill"></i> No hay entrenador asignado al equipo.
    </div>
    {% endif %}
</div>

<!-- Sección Plantilla -->
<div class="mb-5">
    <h3 class="h4 text-foot-green fw-bold mb-2">Plantilla</h3>
    {% if jugadores_equipo %}
    <!-- Buscador -->
    <div class="d-flex justify-content-end mb-3">
        <div class="input-group w-50">
            <span class="input-group-text bg-light">
                <i class="bi bi-search"></i>
            </span>
            <input type="text" id="buscadorJugadores" class="form-control" placeholder="Buscar jugador">
        </div>
    </div>

    <!-- Tabla -->
    <div class="table-responsive">
        <table id="tablaJugadores" class="table text-center table-bordered shadow-sm">
            <thead>
                <tr>
                    <th id="ordenarDorsal" class="bg-success text-white text-center">Dorsal</th>
                    <th id="ordenarJugador" class="bg-success text-white text-center">Jugador</th>
                    <th class="bg-success text-white text-center">Pierna</th>
                    <th id="ordenarAltura" class="bg-success text-white text-center">Altura (cm)</th>
                    <th id="ordenarPeso" class="bg-success text-white text-center">Peso (kg)</th>
                    <th class="bg-success text-white text-center">Capitán</th>
                    {% if is_trainer %}
                    <th class="bg-success text-white text-center">Acciones</th>
                    {% endif %}
                </tr>
            </thead>
            <tbody>
                {% for relacion in jugadores_equipo %}
                <tr class="align-middle">
                    <td class="text-center text-secondary fw-bold" data-dorsal="{% if relacion.perfil_jugador.dorsal %}{{ relacion.perfil_jugador.dorsal }}{% else %}0{% endif %}">
                        {% if relacion.perfil_jugador.dorsal %}
                            {{ relacion.perfil_jugador.dorsal }}
                        {% else %}
                            —
                        {% endif %}
                    </td>
                    <td>
                        <a href="{% url 'usuarios:ver_perfil_usuario' relacion.perfil_jugador.usuario.slug %}" class="text-decoration-none">
                            <div class="d-flex align-items-center justify-content-center">
                                <img src="{% if relacion.perfil_jugador.usuario.foto %}{{ relacion.perfil_jugador.usuario.foto.url }}{% else %}{% static 'img/default_avatar.jpg' %}{% endif %}" 
                                    class="rounded-circle me-2" width="40" height="40" style="object-fit: cover;">
                                <div class="text-start">
                                    <h6 class="mb-0 fw-bold text-color-card">{{ relacion.perfil_jugador.usuario.get_full_name }}</h6>
                                    <small class="text-secondary">{{ relacion.fecha_incorporacion|date:"d M Y" }}</small>
                                </div>
                            </div>
                        </a>
                    </td>
                    <td class="text-center text-secondary">
                        {% if relacion.perfil_jugador.pierna_habil %}
                            <span class="badge rounded-pill" style="background-color: #27a770; color: white;">
                                {{ relacion.perfil_jugador.get_pierna_habil_display }}
                            </span>
                        {% else %}
                            —
                        {% endif %}
                    </td>
                    <td class="text-center text-secondary" data-altura="{% if relacion.perfil_jugador.altura %}{{ relacion.perfil_jugador.altura }}{% else %}0{% endif %}">
                        {% if relacion.perfil_jugador.altura %}
                            {{ relacion.perfil_jugador.altura }}
                        {% else %}
                            —
                        {% endif %}
                    </td>
                    <td class="text-center text-secondary" data-peso="{% if relacion.perfil_jugador.peso %}{{ relacion.perfil_jugador.peso }}{% else %}0{% endif %}">
                        {% if relacion.perfil_jugador.peso %}
                            {{ relacion.perfil_jugador.peso }}
                        {% else %}
                            —
                        {% endif %}
                    </td>
                    <td class="text-center">
                        {% if relacion.perfil_jugador.es_capitan %}
                            <i class="bi bi-star-fill" style="color: #FFD700; font-size: 1.2em;"></i>
                        {% else %}
                            —
                        {% endif %}
                    </td>
                    {% if is_trainer %}
                    <td class="text-center">
                        <div class="btn-group" role="group">
                            <button type="button" class="btn btn-sm btn-outline-primary edit-player-btn" 
                                data-bs-toggle="modal" 
                                data-bs-target="#editPlayerModal"
                                data-jugador-id="{{ relacion.perfil_jugador.id }}"
                                data-dorsal="{% if relacion.perfil_jugador.dorsal %}{{ relacion.perfil_jugador.dorsal }}{% else %}0{% endif %}"
                                data-altura="{{ relacion.perfil_jugador.altura }}"
                                data-peso="{{ relacion.perfil_jugador.peso }}"
                                data-pierna-habil="{{ relacion.perfil_jugador.pierna_habil }}"
                                data-es-capitan="{{ relacion.perfil_jugador.es_capitan }}"
                                data-jugador-nombre="{{ relacion.perfil_jugador.usuario.get_full_name }}">
                                <i class="bi bi-pencil-fill"></i> Editar
                            </button>
                            <button type="button" class="btn btn-sm btn-outline-danger" 
                                data-bs-toggle="modal" 
                                data-bs-target="#confirmRemovePlayerModal"
                                data-equipo-id="{{ equipo.id }}"
                                data-jugador-id="{{ relacion.perfil_jugador.id }}"
                                data-jugador-nombre="{{ relacion.perfil_jugador.usuario.get_full_name }}">
                                <i class="bi bi-trash-fill"></i> Eliminar
                            </button>
                        </div>
                    </td>
                    {% endif %}
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    {% else %}
    <div class="alert alert-info">
        <i class="bi bi-info-circle"></i> No hay jugadores en la plantilla aún.
    </div>
    {% endif %}

    <!-- Botones de Acción (Solo para el entrenador del equipo) -->
    {% if is_trainer %}
    <div class="d-flex flex-wrap gap-3 mt-4 pt-3">
        <!-- BOTÓN AÑADIR JUGADOR -->
        <button type="button" class="btn btn-foot-form-enviar" data-bs-toggle="modal"
            data-bs-target="#addPlayerModal">
            <i class="bi bi-person-plus-fill"></i> Añadir jugador
        </button>

        <button type="button" class="btn text-white px-4 py-2 rounded-3 border-0"
            style="background-color: #504847;" data-bs-toggle="modal" data-bs-target="#confirmDeleteModal">
            <i class="bi bi-shield-slash-fill"></i> Eliminar equipo
        </button>
    </div>
    {% endif %}

    <!-- MODAL PARA EDITAR JUGADOR -->
<div class="modal fade" id="editPlayerModal" tabindex="-1" aria-labelledby="editPlayerLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content rounded-4 border-0 shadow">
            <div class="modal-header border-bottom">
                <h5 class="modal-title fw-bold" id="editPlayerLabel" style="color: #27a770;">
                    <i class="bi bi-pencil-fill"></i> Editar información del jugador
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>

            <div class="modal-body p-4">
                <form id="formulario_editar_jugador" method="POST">
                    {% csrf_token %}
                    <input type="hidden" id="jugadorIdInput" name="jugador_id">
                    
                    <div class="row g-3">
                        <!-- Dorsal -->
                        <div class="col-md-6">
                            <label for="dorsalInput" class="form-label fw-medium">Dorsal</label>
                            <input type="number" class="form-control rounded-3" id="dorsalInput" 
                                name="dorsal" min="1" max="99">
                            <small id="errorDorsal" class="help-text text-danger" aria-live="polite"></small>
                        </div>

                        <!-- Pierna Hábil -->
                        <div class="col-md-6">
                            <label for="piernaHabilInput" class="form-label fw-medium">Pierna Hábil</label>
                            <select class="form-select rounded-3" id="piernaHabilInput" name="pierna_habil">
                                <option value="">-- Seleccionar --</option>
                                <option value="derecha">Derecha</option>
                                <option value="izquierda">Izquierda</option>
                                <option value="ambas">Ambas</option>
                            </select>
                            <small id="errorPiernaHabil" class="help-text text-danger" aria-live="polite"></small>
                        </div>

                        <!-- Altura -->
                        <div class="col-md-6">
                            <label for="alturaInput" class="form-label fw-medium">Altura (cm)</label>
                            <input type="number" class="form-control rounded-3" id="alturaInput" 
                                name="altura" min="100" max="250">
                            <small id="errorAltura" class="help-text text-danger" aria-live="polite"></small>
                        </div>

                        <!-- Peso -->
                        <div class="col-md-6">
                            <label for="pesoInput" class="form-label fw-medium">Peso (kg)</label>
                            <input type="number" class="form-control rounded-3" id="pesoInput" 
                                name="peso" min="30" max="150" step="0.1">
                            <small id="errorPeso" class="help-text text-danger" aria-live="polite"></small>
                        </div>

                        <!-- Capitán -->
                        <div class="col-md-6">
                            <div class="form-check mt-4">
                                <input class="form-check-input" type="checkbox" id="esCapitanInput" 
                                    name="es_capitan">
                                <label class="form-check-label fw-medium" for="esCapitanInput">
                                    Es capitán del equipo
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="d-flex justify-content-end gap-2 mt-4">
                        <button type="button" class="btn btn-light text-secondary px-4 rounded-3"
                            data-bs-dismiss="modal">Cancelar</button>
                        <button type="submit" class="btn text-white px-4 rounded-3"
                            style="background-color: #27a770;">Guardar cambios</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- MODAL PARA AÑADIR JUGADOR -->
<div class="modal fade" id="addPlayerModal" tabindex="-1" aria-labelledby="addPlayerLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content rounded-4 border-0 shadow">
            <div class="modal-header border-bottom">
                <h5 class="modal-title fw-bold" id="addPlayerLabel" style="color: #27a770;">
                    <i class="bi bi-person-plus-fill"></i> Añadir jugador al equipo
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>

            <div class="modal-body p-4">
                {% if jugadores_sin_equipo %}
                    <div class="list-group">
                        {% for jugador in jugadores_sin_equipo %}
                        <div class="list-group-item list-group-item-action d-flex justify-content-between align-items-center rounded-3 mb-2">
                            <div class="d-flex align-items-center">
                                <img src="{% if jugador.usuario.foto %}{{ jugador.usuario.foto.url }}{% else %}{% static 'img/default_avatar.jpg' %}{% endif %}" 
                                    class="rounded-circle me-3" width="50" height="50" style="object-fit: cover;">
                                <div>
                                    <h6 class="mb-0 fw-bold">{{ jugador.usuario.get_full_name }}</h6>
                                    <small class="text-secondary">
                                        {% if jugador.pierna_habil %}Pierna: {{ jugador.get_pierna_habil_display }}{% endif %}
                                    </small>
                                    {% if jugador.altura or jugador.peso %}
                                    <br>
                                    <small class="text-secondary">
                                        {% if jugador.altura %}{{ jugador.altura }}cm{% endif %}
                                        {% if jugador.peso %} • {{ jugador.peso }}kg{% endif %}
                                    </small>
                                    {% endif %}
                                </div>
                            </div>
                            <button type="button" class="btn btn-sm btn-foot-form-enviar add-player-btn" 
                                data-equipo-id="{{ equipo.id }}" 
                                data-jugador-id="{{ jugador.id }}"
                                data-jugador-nombre="{{ jugador.usuario.get_full_name }}">
                                <i class="bi bi-plus-lg"></i> Añadir
                            </button>
                        </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <div class="alert alert-info">
                        <i class="bi bi-info-circle"></i> No hay jugadores disponibles sin equipo.
                    </div>
                {% endif %}
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-light text-secondary px-4 rounded-3" data-bs-dismiss="modal">
                    Cerrar
                </button>
            </div>
        </div>
    </div>
</div>

                    <div class="modal fade" id="confirmDeleteModal" tabindex="-1">
                        <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content rounded-4">

                                <div class="modal-header">
                                    <h5 class="modal-title text-danger"><i class="bi bi-shield-slash-fill"></i> Eliminar
                                        equipo</h5>
                                </div>

                                <div class="modal-body">
                                    <p>
                                        ⚠️ Esta acción <strong>no se puede deshacer</strong>.<br>
                                        ¿Estás seguro de que quieres eliminar el equipo actual?
                                        Tanto los jugadores como tú os quedaréis sin equipo.
                                    </p>
                                </div>

                                <div class="modal-footer">
                                    <button class="btn btn-secondary" data-bs-dismiss="modal">
                                        Cancelar
                                    </button>

                                    <button class="btn btn-danger" id="confirmDeleteBtn"
                                        data-url="{% url 'usuarios:eliminar_cuenta' %}">
                                        Sí, eliminar equipo
                                    </button>
                                </div>

                            </div>
                        </div>
                    </div>

                    <div class="modal fade" id="deletedSuccessModal" tabindex="-1">
                        <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content rounded-4 text-center p-4">

                                <h5 class="text-success mb-3">Cuenta eliminada</h5>
                                <p>Tu cuenta ha sido eliminada correctamente.</p>

                            </div>
                        </div>
                    </div>

            </div>

            <!-- Sección Estadísticas -->
            <div class="mb-5">
                <h3 class="h4 text-foot-green fw-bold mb-2">Estadísticas generales del equipo</h3>
                <p class="fs-5 text-secondary">Listado de estadísticas generales del equipo</p>
            </div>

        </div>

        <!-- COLUMNA DERECHA: Foto de Perfil (Orden 1 en móvil, 2 en escritorio) -->
        <div class="col-md-4 order-1 order-md-2 d-flex flex-column align-items-center gap-4">

            <!-- Lógica para mostrar la foto -->
            {% if equipo.escudo %}
            <!-- Si tiene foto subida -->
            <img src="{{ equipo.escudo.url }}" alt="Escudo de equipo"
                class="bg-shield-dark border-0 shadow-sm rounded-4"
                style="width: 350px; height: 350px; object-fit: cover;">
            {% else %}
            <!-- Placeholder si no tiene foto (Imagen genérica o iniciales) -->
            <!-- Usamos placehold.co con tus colores: fondo verde, texto blanco -->
            <img src="{% static 'img/default_shield.png' %}" alt="Sin escudo"
                class="bg-shield-dark border-0 shadow-sm rounded-4"
                style="width: 350px; height: 350px; object-fit: cover;">
            {% endif %}
            <div class="w-100 card shadow-sm bg-card-dark">
                <!-- Sección Lesiones -->
                <div class="card-body text-center">
                    <h3 class="h4 text-foot-green fw-bold mb-2">Últimos resultados</h3>
                    <p class="fs-5 text-secondary">Últimos partidos del equipo</p>

                    <!-- Sección Sanciones -->
                    <h3 class="h4 text-foot-green fw-bold mb-2">Próximos partidos</h3>
                    <p class="fs-5 text-secondary">Próximos partidos del equipo</p>
                </div>


            </div>

            <div class="w-100 card shadow-sm bg-card-dark">

                <div class="card-body">
                    <h3 class="h5 text-foot-green fw-bold mb-3">
                        Información de contacto
                    </h3>
                    <ul class="list-unstyled mb-0">
                        <li class="mb-2 text-secondary">
                            <strong>Teléfono:</strong>
                            {{ equipo.telefono }}
                        </li>
                        <li class="mb-2 text-secondary">
                            <strong>Dirección:</strong>
                            {{ equipo.direccion }}
                            <br>
                            <br>
                            <iframe width="100%" height="300" style="border:0; border-radius: 10px;" loading="lazy"
                                referrerpolicy="no-referrer-when-downgrade"
                                src="https://www.google.com/maps?q={{ equipo.direccion|urlencode }}&output=embed">
                            </iframe>
                        </li>
                    </ul>
                </div>

            </div>

        </div>
    </div>
    {% endblock %}
    {% block extra_js %}
    <script>
        const apiUrlAgregarJugador = "{% url 'equipos:agregar_jugador_equipo' 999 888 %}".replace('/999/888/', '/{equipo_id}/{jugador_id}/');
        const apiUrlEditarJugador = "{% url 'equipos:editar_jugador' 999 %}".replace('/999/', '/{jugador_id}/');
    </script>
    <script src="{% static 'js/editarDatosEquipo.js' %}"></script>
    <script src="{% static 'js/añadirJugadorEquipo.js' %}"></script>
    <script src="{% static 'js/listadoJugadoresPlantilla.js' %}"></script>
    <script src="{% static 'js/editarJugadorPlantilla.js' %}"></script>
    {% endblock %}